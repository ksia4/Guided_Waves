\section{Obliczenia MES i wyznaczanie krzywych dyspersji oraz wzbudzalności}
\label{cha:obliczenia_mes}

W tej sekcji przedstawione są kolejno sposoby tworzenia siatki węzłów, budowy elementów skończonych, wyznaczania lokalnych i globalnych macierzy modelu MES pręta i wyznaczani krzywych dyspersji oraz wzbudzalności. Program umożliwia tworzenie modelu MES z wykorzystanie elementów czworościennych oraz sześciennych. Krzywe dyspersji oraz wzbudzalności można wyznaczyć z obliczonego modelu, ale jest też opcja wczytania danych modelu z programu MARC.

Strukturę projektu przedstawia rysunek \ref{fig:okno_projektu}. Implementacja zagadnień związanych z obliczeniami MES oraz wyznaczaniem krzywych dyspersji z obliczonego modelu znajduje się w katalogu MES\textunderscore dir. Katalog MARC zawiera funkcje umożliwiające wczytanie danych z programu MARC i na ich podstawie wyznaczeniu krzywych dyspersji.

\begin{figure}[h]
\centering
\includegraphics[width=5cm]{Zdjecia/5/okno_projektu}
\caption{Widok okna projektu}
\label{fig:okno_projektu}
\end{figure}

\input{5_2A_czworoscienne}


\input{5_2B_szescienne}



\subsection{Pozostałe moduły katalogu MES\_dir}
\label{cha:pozostale_moduly}

 \( \textbf{Moduł config} \).

W tym module przechowywane są dane wykorzystywane w innych częściach programu. Jego zawartość podana jest poniżej.

\vspace {3mm}
ROOT\_DIR = os.path.dirname(os.path.abspath(\_\_file\_\_))

\#sciezka do katalogu MES\_dir
\vspace {3mm}
ndof = 3    \# liczba stopni swobody

kvect\_min = 0

kvect\_no\_of\_points = 0

kvect\_max = 2*pi
\vspace {3mm}
k = []  \# globalna macierz sztywnosci

m = []  \# globalna macierz mas

m\_focused\_rows = [] \#globalna macierz mas - skupiona wierszami

ml = []

m0 = []

mr = []

kl = []

k0 = []

kr = []
\vspace {3mm}
force = []
\vspace {3mm}
\# Stale materialowe

young\_mod = 70000

poisson\_coef = 0.3

density = 2.7*1e-9
\vspace {3mm}
\# Wyswietlanie siatki na plaszczyznie, siatki w 3D i triangulacji

show\_plane = False

show\_bar = False

show\_elements = False
\vspace {3mm}

Pierwszym elementem jest ścieżka do katalogu pozwalająca wygodnie odnosić się do niego w funkcjach zapisujących i wczytujących dane z plików. Poniżej znajdują się wartość minimalna, maksymalna oraz liczba próbek wartości liczby falowej, dla których to wartości obliczane będą częstości własne. Następnie kolejno zawarte są macierze i podmacierze modelu MES, siła wymuszająca wykorzystywana przy obliczaniu wzbudzalności, stałe materiałowe konstrukcji pręta i wartości logiczne określające czy wyświetlać siatkę lub element skończone modelu.

\vspace {3mm}

 \( \textbf{Moduł MES} \).
W tym module zawarte są dwie funkcje, które są przykładami budowy modelu za pomocą elementów czworościennych oraz sześciościennych.

\textit{mes4(radius, numOfCircles, numOfPointsAtFirstCircle)} - funkcja przyjmuje jako argumenty promień pręta - radius, liczbę okręgów na jednej płaszczyźnie siatki - numOfCircles oraz liczbę węzłów na pierwszym okręgu siatki - numOfPointsAtFirstCircle. Poniżej znajduje się całość kodu tej funkcji.

\vspace {3mm}

    vertices = mesh4.circleMeshFull(radius, numOfCircles, numOfPointsAtFirstCircle)

    if config.show\_plane:

        mesh4.drawPlane(vertices)

    if config.show\_bar:

        mesh4.drawBar(vertices)

\vspace {3mm}
    indices = mesh4.triangulation(vertices)

    \# mesh.draw\_triangulation(vertices, indices)

    if config.show\_elements:

        mesh4.drawTriangulation(vertices, indices)

\vspace {3mm}
    start = time.clock()

    config.k = assembling4.assembleGlobalStiff\_matrix(vertices, indices, config.young\_mod, config.poisson\_coef)

    \# assembling.drawMatrixSparsity(config.k)

    print("Macierz sztywnosci gotowa")

    print("Wykonywanie: ", time.clock() - start)

\vspace {3mm}
    config.m = assembling4.assembleGlobalMassMatrix(vertices, indices, config.density)

    config.m\_focused\_rows = assembling4.focuseMatrixRows(config.m)

    \# assembling.drawMatrixSparsity(config.m)

    print("Macierz mas gotowa")

    print("wykonywanie: ", time.clock() - start)

\vspace {3mm}

W pierwszej lini uzyskiwana jest macierz współrzędnych węzłów siatki. Następnie siatka jest wyświetlana w na płaszczyźnie, bądź w rzucie izometrycznym jeśli wartości z modułu config mają wartości TRUE. Kolejnym etapem jest tworzenie elementów skończonych i warunkowe ich wyświetlanie. Wartość start przechowuje czas, w którym rozpoczyna się obliczanie macierzy sztywności - k. Po obliczeniu też macierzy wyświetlanu jest komunikat z czasem obliczeń.  Podobnie poniżej w przypadu macierzy mas.

\textit{mes8(numberOfPlanes, radius, numberOfCircles, numberOfPointsOnCircle, addNodes)} - funkcja przyjmuje jako argumenty liczbę płaszczyzn siatki - numberOfPlanes, promień pręta - radius, liczbę okręgów na jednej płaszczyźnie siatki - numOfCircles, liczbę węzłów na pierwszym okręgu siatki - numOfPointsOnCircle oraz liczbę dodatkowych punktów na każdym kolejnym okręgu siatki przy zastosowaniu odpowiedniego jej typu - addNodes. Poniżej znajduje się całość kodu tej funkcji.

\vspace {3mm}
    \# brickMesh(radius, numberOfPlanes, numberOfCircles, numberOfPointsOnCircle)

    vertices = mesh8.brickMesh(radius, numberOfPlanes, numberOfCircles, numberOfPointsOnCircle)

    \# createBrickElements(brickVertices, numberOfPlanes, numberOfCircles, numberOfPointsOnCircle)

    indices = mesh8.createBrickElements(vertices, 3, 3, 16)

\vspace {3mm}
    start = time.clock()

    config.k = assembling8.assembleGlobalStiffMatrix(vertices, indices)

    print("Macierz sztywnosci gotowa")

    print("Wykonywanie: ", time.clock() - start, " [s]")

    print("Wykonywanie: ", (time.clock() - start)/3600, " [h]")

    start = time.clock()

\vspace {3mm}
    config.m = assembling8.assembleGlobalMassMatrix(vertices, indices, config.density)

    config.m\_focused\_rows = assembling8.focuse\_matrix\_rows(config.m)

    print("Macierz mas gotowa")

    print("wykonywanie: ", time.clock() - start, " [s]")

    print("wykonywanie: ", (time.clock() - start)/3600, " [h]")

\vspace {3mm}
W tym przykładzie zastosowano siatkę brickMesh. Po wyznaczeniu współrzędnych węzłów oraz zbudowaniu elementów skończonych, obliczane są macierze mas i sztywności.

 \( \textbf{Moduł MES} \).